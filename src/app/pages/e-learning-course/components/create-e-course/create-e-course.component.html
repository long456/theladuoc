<div class="title-page">
  <span *ngIf="isCreate">
    {{'add_new'|translate}}
  </span>
  <span *ngIf="!isCreate">
    {{'modify'|translate}}
  </span>
  {{'e_learning_course' | translate}}
</div>

<form nz-form [formGroup]="courseForm">
  <div nz-row [nzGutter]=[16,16]>
    <div nz-col [nzXs]="24" [nzLg]="14" [nzXl]="18">
      <div nz-row [nzGutter]=[16,16]>
        <div nz-col [nzXs]="24" [nzSm]="24" [nzXl]="16">
          <!-- Tên khoá học -->
          <div style="margin-bottom: 16px;">
            <div class="d-flex align-items-center">
              <span class="text-label" style="margin-right: 8px;">
                {{controlNames.name | translate}}
                <span class="text-danger">*</span>
              </span>

              <span nzTooltipTitle="{{'guide_course_name' | translate}}" nzTooltipPlacement="top" nz-tooltip nz-icon nzType="question-circle" nzTheme="outline"></span>
            </div>
            <input nz-input autofocus formControlName="name" [nzStatus]="(courseForm.get('name')?.invalid && (courseForm.get('name')?.touched || isSubmit)) ? 'error' : ''">
            <span class="text-danger message-error" *ngIf="courseForm.get('name')?.invalid && courseForm.get('name')?.touched">
              {{ getErrorMessage('name') }}
            </span>
          </div>
          <!-- Giới thiệu ngắn -->
          <div>

            <div class="d-flex align-items-center">
              <span class="text-label" style="margin-right: 8px;">
                {{controlNames.description | translate}}
                <span class="text-danger">*</span>
              </span>
              <span nzTooltipTitle="{{'guide_course_description' | translate}}" nzTooltipPlacement="top" nz-tooltip nz-icon nzType="question-circle" nzTheme="outline"></span>
            </div>
            <textarea nz-input autofocus formControlName="description" [nzStatus]="(courseForm.get('description')?.invalid && (courseForm.get('description')?.touched || isSubmit)) ? 'error' : ''">
            </textarea>
            <span class="text-danger message-error" *ngIf="courseForm.get('description')?.invalid && courseForm.get('description')?.touched">
              {{ getErrorMessage('description') }}
            </span>
          </div>
        </div>
        <!-- Giá -->
        <div nz-col [nzXs]="24" [nzSm]="24" [nzXl]="8">
          <!--          <div nz-row [nzGutter]=[16,16]>-->
          <!--            <div nz-col [nzXs]="24" [nzSm]="12" [nzXl]="24">-->
          <!--              <span class="text-label">-->
          <!--                {{controlNames.price}}-->
          <!--                <nz-input-number class="input-nz-number" formControlName="price" [nzMin]="0"-->
          <!--                  [nzStep]="1"></nz-input-number>-->
          <!--              </span>-->
          <!--            </div>-->
          <!--            <div nz-col [nzXs]="24" [nzSm]="12" [nzXl]="24">-->
          <!--              <span class="text-label">-->
          <!--                {{controlNames.oldPrice}}-->
          <!--                <nz-input-number class="input-nz-number" formControlName="oldPrice" [nzMin]="0"-->
          <!--                  [nzStep]="1"></nz-input-number>-->
          <!--              </span>-->
          <!--            </div>-->
          <!--          </div>-->
        </div>
        <!-- Giá mới-->
        <div nz-col [nzXs]="24" [nzSm]="24" [nzXl]="8" *ngIf="isSpecialCourse">
          <div nz-row [nzGutter]=[16,16]>
            <!--30 day-->
            <div nz-col [nzXs]="24" [nzSm]="12" [nzXl]="24">
              <span class="text-label">
                {{controlNames.price30Day | translate }}
                <nz-input-number class="input-nz-number" formControlName="price30Day" [nzMin]="0" [nzStep]="1" [nzStatus]="(courseForm.invalid && courseForm.hasError('invalidPrice') &&
                                             (courseForm.get('price30Day')?.touched || isSubmit)) ? 'error' : ''"></nz-input-number>
                <span class="text-danger message-error" *ngIf="courseForm.invalid && courseForm.hasError('invalidPrice') && courseForm.get('price30Day')?.touched">
                  Khóa học đặc biệt phải có tối thiểu 1 loại giá mới khả dụng!
                </span>
              </span>
            </div>
            <!--90 day-->
            <div nz-col [nzXs]="24" [nzSm]="12" [nzXl]="24">
              <span class="text-label">
                {{controlNames.price90Day | translate}}
                <nz-input-number class="input-nz-number" formControlName="price90Day" [nzMin]="0" [nzStep]="1" [nzStatus]="(courseForm.invalid && courseForm.hasError('invalidPrice') &&
                                             (courseForm.get('price90Day')?.touched || isSubmit)) ? 'error' : ''"></nz-input-number>
                <span class="text-danger message-error" *ngIf="courseForm.invalid && courseForm.hasError('invalidPrice') && courseForm.get('price90Day')?.touched">Khóa
                  học đặc biệt phải có tối thiểu 1 loại giá mới khả dụng!</span>
              </span>
            </div>
            <!--180 day-->
            <div nz-col [nzXs]="24" [nzSm]="12" [nzXl]="24">
              <span class="text-label">
                {{controlNames.price180Day | translate}}
                <nz-input-number class="input-nz-number" formControlName="price180Day" [nzMin]="0" [nzStep]="1" [nzStatus]="(courseForm.invalid && courseForm.hasError('invalidPrice') &&
                                             (courseForm.get('price180Day')?.touched || isSubmit)) ? 'error' : ''"></nz-input-number>
                <span class="text-danger message-error" *ngIf="courseForm.invalid && courseForm.hasError('invalidPrice') && courseForm.get('price180Day')?.touched">
                  Khóa học đặc biệt phải có tối thiểu 1 loại giá mới khả dụng!
                </span>
              </span>
            </div>
            <!--360 day-->
            <div nz-col [nzXs]="24" [nzSm]="12" [nzXl]="24">
              <span class="text-label">
                {{controlNames.price365Day | translate}}
                <nz-input-number class="input-nz-number" formControlName="price365Day" [nzMin]="0" [nzStep]="1" [nzStatus]="(courseForm.invalid && courseForm.hasError('invalidPrice') &&
                                             (courseForm.get('price365Day')?.touched || isSubmit)) ? 'error' : ''"></nz-input-number>
                <span class="text-danger message-error" *ngIf="courseForm.invalid && courseForm.hasError('invalidPrice') && courseForm.get('price365Day')?.touched">
                  Khóa học đặc biệt phải có tối thiểu 1 loại giá mới khả dụng!
                </span>
              </span>
            </div>
            <!--Forever-->
            <div nz-col [nzXs]="24" [nzSm]="12" [nzXl]="24">
              <span class="text-label">
                {{controlNames.priceForever | translate}}
                <nz-input-number class="input-nz-number" formControlName="priceForever" [nzMin]="0" [nzStep]="1" [nzStatus]="(courseForm.invalid && courseForm.hasError('invalidPrice') &&
                                             (courseForm.get('priceForever')?.touched || isSubmit)) ? 'error' : ''"></nz-input-number>
                <span class="text-danger message-error" *ngIf="courseForm.invalid && courseForm.hasError('invalidPrice') && courseForm.get('priceForever')?.touched">
                  Khóa học đặc biệt phải có tối thiểu 1 loại giá mới khả dụng!
                </span>
              </span>
            </div>
          </div>
        </div>

        <!-- Giá cũ-->
        <div nz-col [nzXs]="24" [nzSm]="24" [nzXl]="8" *ngIf="isSpecialCourse">
          <div nz-row [nzGutter]=[16,16]>
            <!--30 day-->
            <div nz-col [nzXs]="24" [nzSm]="12" [nzXl]="24">
              <span class="text-label">
                {{controlNames.price30DayOld | translate}}
                <nz-input-number class="input-nz-number" formControlName="price30DayOld" [nzMin]="0" [nzStep]="1"></nz-input-number>
              </span>
            </div>
            <!--90 day-->
            <div nz-col [nzXs]="24" [nzSm]="12" [nzXl]="24">
              <span class="text-label">
                {{controlNames.price90DayOld | translate}}
                <nz-input-number class="input-nz-number" formControlName="price90DayOld" [nzMin]="0" [nzStep]="1"></nz-input-number>
              </span>
            </div>
            <!--180 day-->
            <div nz-col [nzXs]="24" [nzSm]="12" [nzXl]="24">
              <span class="text-label">
                {{controlNames.price180DayOld | translate}}
                <nz-input-number class="input-nz-number" formControlName="price180DayOld" [nzMin]="0" [nzStep]="1"></nz-input-number>
              </span>
            </div>
            <!--360 day-->
            <div nz-col [nzXs]="24" [nzSm]="12" [nzXl]="24">
              <span class="text-label">
                {{controlNames.price365DayOld | translate}}
                <nz-input-number class="input-nz-number" formControlName="price365DayOld" [nzMin]="0" [nzStep]="1"></nz-input-number>
              </span>
            </div>
            <!--Forever-->
            <div nz-col [nzXs]="24" [nzSm]="12" [nzXl]="24">
              <span class="text-label">
                {{controlNames.priceForeverOld | translate}}
                <nz-input-number class="input-nz-number" formControlName="priceForeverOld" [nzMin]="0" [nzStep]="1"></nz-input-number>
              </span>
            </div>
          </div>
        </div>
        <!-- Ảnh đại diện -->
        <div nz-col [nzXs]="24" [nzSm]="12">
          <span class="text-label">
            {{controlNames.thumbImg | translate}} (370 x 270)
            <span class="text-danger message-error" *ngIf="courseForm.get('thumbImg')?.invalid && courseForm.get('thumbImg')?.touched">
              {{ getErrorMessage('thumbImg') }}
            </span>
            <span class="text-danger">*</span>
          </span>

          <div class="select-file">
            <div class="btn-select-file" (click)="selectFile('thumbImg')" *ngIf="!courseForm.get('thumbImg')?.value">
              <span nz-icon nzType="plus" nzTheme="outline"></span>
              <div style="margin-top: 8px;">{{'upload' | translate}}</div>
            </div>
            <img class="img-preview" [src]="courseForm.get('thumbImg')?.value" *ngIf="courseForm.get('thumbImg')?.value">

            <div class="overlay" *ngIf="courseForm.get('thumbImg')?.value">
              <div class="btn-file">
                <a nz-button nzType="link" nz-tooltip nzTooltipTitle="{{'upload_new_image' | translate}}" (click)="selectFile('thumbImg')">
                  <span nz-icon nzType="upload"></span>
                </a>
                <a nz-button nzType="link" nz-tooltip nzTooltipTitle="{{ 'remove' | translate }}" (click)="deleteImg('thumbImg')">
                  <span nz-icon nzType="delete"></span>
                </a>
              </div>
            </div>
          </div>
        </div>
        <!-- Ảnh banner -->
        <div nz-col [nzXs]="24" [nzSm]="12">
          <span class="text-label">{{controlNames.imgBanner | translate}} (1300 x 700)</span>
          <div class="select-file">
            <div class="btn-select-file" (click)="selectFile('imgBanner')" *ngIf="!courseForm.get('imgBanner')?.value">
              <span nz-icon nzType="plus" nzTheme="outline"></span>
              <div style="margin-top: 8px;">{{'upload' | translate}}</div>
            </div>
            <img class="img-preview" [src]="courseForm.get('imgBanner')?.value" *ngIf="courseForm.get('imgBanner')?.value">

            <div class="overlay" *ngIf="courseForm.get('imgBanner')?.value">
              <div class="btn-file">
                <a nz-button nzType="link" nz-tooltip nzTooltipTitle="{{'upload_new_image' | translate}}" (click)="selectFile('imgBanner')">
                  <span nz-icon nzType="upload"></span>
                </a>
                <a nz-button nzType="link" nz-tooltip nzTooltipTitle="{{ 'remove' | translate }}" (click)="deleteImg('imgBanner')">
                  <span nz-icon nzType="delete"></span>
                </a>
              </div>
            </div>
          </div>
        </div>
        <!-- Ảnh chứng chỉ -->
        <div nz-col [nzXs]="24" [nzSm]="12">
          <span class="text-label">{{controlNames.certificateImage | translate}}</span>
          <span class="text-danger message-error" *ngIf="courseForm.get('certificateImage')?.hasError('requireCerImg') &&
                    (courseForm.get('certificateImage')?.touched || isSubmit)">
            Ảnh chứng chỉ không được để trống!
          </span>
          <div class="select-file">
            <div class="btn-select-file" (click)="selectFile('certificateImage')" *ngIf="!courseForm.get('certificateImage')?.value">
              <span nz-icon nzType="plus" nzTheme="outline"></span>
              <div style="margin-top: 8px;">{{'upload' | translate}}</div>
            </div>
            <img class="img-preview" [src]="courseForm.get('certificateImage')?.value" *ngIf="courseForm.get('certificateImage')?.value">

            <div class="overlay" *ngIf="courseForm.get('certificateImage')?.value">
              <div class="btn-file">
                <a nz-button nzType="link" nz-tooltip nzTooltipTitle="{{'upload_new_image' | translate}}" (click)="selectFile('certificateImage')">
                  <span nz-icon nzType="upload"></span>
                </a>
                <a nz-button nzType="link" nz-tooltip nzTooltipTitle="{{ 'remove' | translate }}" (click)="deleteImg('certificateImage')">
                  <span nz-icon nzType="delete"></span>
                </a>
              </div>
            </div>
          </div>
        </div>
        <!-- Link video giới thiệu -->
        <div nz-col [nzSpan]="24">
          <div nz-row>
            <div nz-col [nzXs]="24" [nzSm]="24" [nzXl]="16">
              <span class="text-label">
                {{controlNames.introVideo | translate}}
                <span class="text-danger message-error" *ngIf="courseForm.get('introVideo')?.invalid && courseForm.get('introVideo')?.touched">
                  {{ getErrorMessage('introVideo') }}
                </span>
              </span>
              <input nz-input autofocus formControlName="introVideo" [nzStatus]="(courseForm.get('introVideo')?.invalid && (courseForm.get('introVideo')?.touched || isSubmit)) ? 'error' : ''">
            </div>
          </div>
        </div>

        <div nz-col [nzSpan]="24">
          <span class="text-label">
            {{controlNames.overviewDescription | translate}}
            <span class="text-danger">*</span>
            <span class="text-danger message-error" *ngIf="courseForm.get('overviewDescription')?.invalid && courseForm.get('overviewDescription')?.touched">
              {{ getErrorMessage('overviewDescription') }}
            </span>
          </span>
          <ckeditor name="ckeditor_text" formControlName="overviewDescription" editorUrl="https://cdn.ckeditor.com/4.14.0/full/ckeditor.js" [config]="ckEditorConfig"></ckeditor>
        </div>
      </div>
    </div>

    <!-- Right -->
    <div nz-col [nzXs]="24" [nzLg]="10" [nzXl]="6">
      <div nz-row [nzGutter]=[16,16]>
        <div nz-col [nzXs]="24" [nzSm]="24">
          <div class="d-flex justify-content-between align-items-center">
            <span class="text-label">
              {{controlNames.teacherId | translate}}
              <span class="text-danger">*</span>
            </span>
            <span nzTooltipTitle="{{'guide_course_teacher' | translate}}" nzTooltipPlacement="top" nz-tooltip nz-icon nzType="question-circle" nzTheme="outline"></span>
          </div>
          <div>
            <nz-select formControlName="teacherId">
              <nz-option *ngFor="let teacher of listTeacher" [nzValue]="teacher.id" [nzLabel]="teacher.fullName">
              </nz-option>
            </nz-select>
          </div>
          <span class="text-danger message-error" *ngIf="courseForm.get('teacherId')?.invalid && courseForm.get('teacherId')?.touched">
            {{ getErrorMessage('teacherId') }}
          </span>
        </div>

        <div nz-col [nzXs]="24" [nzSm]="24">
          <span class="text-label">
            {{controlNames.categoryId | translate}}
            <span class="text-danger">*</span>
            <span class="text-danger message-error" *ngIf="courseForm.get('categoryId')?.invalid && courseForm.get('categoryId')?.touched">
              {{ getErrorMessage('categoryId') }}
            </span>
          </span>
          <div>
            <nz-select formControlName="categoryId">
              <nz-option *ngFor="let category of listCategory" [nzValue]="category.id" [nzLabel]="category.title">
              </nz-option>
            </nz-select>
          </div>
        </div>

        <div nz-col [nzXs]="24" [nzSm]="24">
          <span class="text-label">
            {{controlNames.type | translate}}
            <span class="text-danger">*</span>
            <span class="text-danger message-error" *ngIf="courseForm.get('type')?.invalid && courseForm.get('type')?.touched">
              {{ getErrorMessage('type') }}
            </span>
          </span>
          <div>
            <nz-select formControlName="type">
              <nz-option [nzValue]="1" [nzLabel]="'free_courses' | translate"></nz-option>
              <nz-option [nzValue]="2" [nzLabel]="'membership_courses' | translate"></nz-option>
              <nz-option [nzValue]="3" [nzLabel]="'special_courses' | translate"></nz-option>
              <nz-option [nzValue]="4" [nzLabel]="'partner_courses' | translate"></nz-option>
              <nz-option [nzValue]="5" [nzLabel]="'tutor_courses' | translate"></nz-option>
            </nz-select>
          </div>
        </div>

        <div *ngIf="showMemberPolicyLevel" nz-col [nzXs]="24" [nzSm]="24">
          <span class="text-label">
            {{controlNames.memberPolicyLevelId | translate}}
            <span class="text-danger message-error" *ngIf="courseForm.get('memberPolicyLevelId')?.invalid && courseForm.get('memberPolicyLevelId')?.touched">
              {{ getErrorMessage('memberPolicyLevelId') }}
            </span>
          </span>
          <div>
            <nz-select formControlName="memberPolicyLevelId">
              <nz-option *ngFor="let policy of listMemberPolicyLevel" [nzValue]="policy.id" [nzLabel]="policy.name">
              </nz-option>
            </nz-select>
          </div>
        </div>

        <div *ngIf="showMemberPolicyLevel" nz-col [nzXs]="24" [nzSm]="24">
          <span class="text-label">
            {{controlNames.completedPoint | translate}}
          </span>

          <nz-input-number class="input-nz-number" formControlName="completedPoint" [nzMin]="0" [nzStep]="1"></nz-input-number>
        </div>

        <div nz-col [nzXs]="24" [nzSm]="24">
          <span class="text-label">
            {{controlNames.level | translate}}
            <span class="text-danger">*</span>
            <span class="text-danger message-error" *ngIf="courseForm.get('level')?.invalid && courseForm.get('level')?.touched">
              {{ getErrorMessage('level') }}
            </span>
          </span>
          <div>
            <nz-select formControlName="level">
              <nz-option [nzValue]="1" [nzLabel]="'Sơ cấp'"></nz-option>
              <nz-option [nzValue]="2" [nzLabel]="'Trung cấp'"></nz-option>
              <nz-option [nzValue]="3" [nzLabel]="'Cao cấp'"></nz-option>
            </nz-select>
          </div>
        </div>

        <div nz-col [nzXs]="24" [nzSm]="24">
          <span class="text-label">
            {{controlNames.language | translate}}
            <span class="text-danger">*</span>
            <span class="text-danger message-error" *ngIf="courseForm.get('language')?.invalid && courseForm.get('language')?.touched">
              {{ getErrorMessage('language') }}
            </span>
          </span>
          <div>
            <nz-select formControlName="language">
              <nz-option [nzValue]="1" [nzLabel]="'Tiếng Việt'"></nz-option>
              <nz-option [nzValue]="2" [nzLabel]="'Tiếng Anh'"></nz-option>
            </nz-select>
          </div>
        </div>

        <div nz-col [nzXs]="24" [nzSm]="12">
          <div class="text-label">{{controlNames.isCertificate | translate}}</div>
          <nz-switch formControlName="isCertificate">
          </nz-switch>
        </div>

        <div nz-col class="mb-30" [nzXs]="24" [nzSm]="12">
          <div class="text-label">
            {{controlNames.status | translate}}
            <span class="text-danger message-error" *ngIf="courseForm.get('status')?.invalid && courseForm.get('status')?.touched">
              {{ getErrorMessage('status') }}
            </span>
          </div>
          <nz-switch formControlName="status">
          </nz-switch>
        </div>

        <div nz-col [nzSpan]="24">
          <div class="btn-panel">
            <button class="btn primary" nz-button [nzLoading]="loading" (click)="edit()">
              <span *ngIf="isCreate">
                {{'add_new'|translate}}
              </span>
              <span *ngIf="!isCreate">
                {{'save'|translate}}
              </span>
            </button>
            <button class="btn" nz-button (click)="navigateBack()">
              {{'cancel'|translate}}
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</form>