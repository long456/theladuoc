<div class="title-page">
    Báo cáo khóa học phễu
</div>
<div>
    <div nz-row style="margin-bottom: 20px;">
        <div nz-col [nzSpan]="24" class="search-area d-flex">
            <div class="d-flex justify-content-start">
                <button nz-button type="button" [nzType]="'primary'" (click)="openSearch()"
                    style="margin-right: 10px;">Lọc</button>
            </div>
            <div class="d-flex justify-content-end w-100">
                <button nz-button type="button" [nzType]="'primary'" (click)="syncData()">
                    <span nz-icon nzType="sync" nzTheme="outline"></span></button>
            </div>
        </div>
    </div>

    <nz-table #nzTable [nzLoading]="isLoading" [nzData]="items" nzTableLayout="fixed" [nzScroll]="{ y: 'auto' }"
        nzShowPagination="false" (nzQueryParams)="onQueryParamsChange($event)">
        <thead>
            <tr>
                <th nzWidth="40px" [nzLeft]="true"></th>
                <th [nzLeft]="true" nzWidth="60px">STT</th>
                <th nzWidth="180px">Tên khóa học</th>
                <th nzWidth="180px">Tên lớp học</th>
                <th nzWidth="120px" nzColumnKey="totalAdsAmount" [nzSortFn]="true">Số tiền Ads</th>
                <th nzWidth="120px" nzColumnKey="totalNumberOfRegistrations" [nzSortFn]="true">Số lượt đăng ký</th>
                <th nzWidth="80px" nzColumnKey="totalCpa" [nzSortFn]="true">CPA</th>
                <th nzWidth="120px" nzColumnKey="totalOtherCost" [nzSortFn]="true">Các chi phí khác</th>

                <th nzWidth="120px" nzColumnKey="totalRegistrationTicketNumber" [nzSortFn]="true">Số vé đăng ký</th>
                <th nzWidth="120px" nzColumnKey="totalNumberOfTicketsSold" [nzSortFn]="true">Số vé bán ra</th>
                <th nzWidth="120px" nzColumnKey="totalTicketSalesRevenue" [nzSortFn]="true">Doanh thu bán vé</th>
                <th nzWidth="120px" nzColumnKey="totalNumberOfParticipants" [nzSortFn]="true">Số người tham gia</th>
                <th nzWidth="120px" nzColumnKey="totalNumberOfPeopleDepositing" [nzSortFn]="true">Số người đặt cọc</th>
                <th nzWidth="120px" nzColumnKey="totalNumberPeopleTransferredEnough" [nzSortFn]="true">Số người chuyển
                    đủ</th>
                <th nzWidth="120px" nzColumnKey="courseRevenue" [nzSortFn]="true">Doanh thu khóa học</th>
                <th nzWidth="120px" nzColumnKey="courseProfits" [nzSortFn]="true">Lợi nhuận khóa học</th>
                <th nzWidth="150px">Tên diễn giả</th>
                <th nzWidth="120px">Số điện thoại</th>
                <th nzWidth="150px">Tổ chức</th>
                <th [nzRight]="true" nzWidth="120px">Thao tác</th>
            </tr>
        </thead>
        <tbody>
            <ng-container *ngFor="let data of nzTable.data; let i = index">
                <tr>
                    <!-- [nzExpand]="expandSet.has(data.courseId)" (nzExpandChange)="onExpandChange(data.courseId, $event)" -->
                    <td [nzLeft]="true"></td>
                    <td [nzLeft]="true">{{i + 1}} </td>
                    <!-- <td> {{ data.funnelCourseDate | date: 'dd-MM-yyy'}} </td> -->
                    <td> {{ data.courseName }} </td>
                    <td> {{ data.className }} </td>
                    <td> {{ data.totalAdsAmount }} </td>
                    <td> {{ data.totalNumberOfRegistrations }} </td>
                    <td> {{ data.totalCpa }} </td>
                    <td> {{ data.totalOtherCost }} </td>


                    <td> {{ data.totalRegistrationTicketNumber }} </td>
                    <td> {{ data.totalNumberOfTicketsSold }}</td>
                    <td> {{ data.totalTicketSalesRevenue | number }} </td>
                    <td> {{ data.totalNumberOfParticipants }} </td>
                    <td> {{ data.totalNumberOfPeopleDepositing }}</td>
                    <td> {{ data.totalNumberPeopleTransferredEnough }} </td>
                    <td> {{ data.courseRevenue | number }} </td>
                    <td> {{ data.courseProfits | number }} </td>
                    <td> {{ data.speakerName }} </td>
                    <td> {{ data.phoneNumber }} </td>
                    <td> {{ data.organizationName }} </td>
                    <td [nzRight]="true">
                        <button nz-button nzType="default" nzShape="circle" nz-tooltip
                            nzTooltipTitle="Xem quá trình hoạt động" (click)="onSeeProcess()"><span nz-icon
                                nzType="rise" nzTheme="outline"></span></button>
                        <button nz-button nzType="default" nzShape="circle" nz-tooltip
                            nzTooltipTitle="Xem bảng xếp hạng" (click)="onSeeRanking()"> <span nz-icon
                                nzType="ordered-list" nzTheme="outline"></span></button>
                    </td>
                </tr>
            </ng-container>
        </tbody>
    </nz-table>
    <div class="table-footer paging-table header-btn">
        <div class="paging-table-right" style="margin-top: 20px;" *ngIf="items.length > 0">
            <nz-pagination class="pagination" [(nzPageSize)]="pageSize" [(nzPageIndex)]="currentPage"
                [nzTotal]="totalItem" (nzPageIndexChange)="onPageChange($event)"
                (nzPageSizeChange)="nzPageSizeChange($event);" [nzShowTotal]="totalTemplate"
                nzShowSizeChanger></nz-pagination>
            <ng-template #totalTemplate let-total>Tổng có {{ totalItem }} khóa học</ng-template>
        </div>
    </div>
</div>